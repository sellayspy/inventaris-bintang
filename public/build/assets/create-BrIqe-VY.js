import{u as D,r as n,j as e}from"./app-B0SzeqCG.js";import{A as F}from"./app-layout-BnD_lHqo.js";/* empty css            */import"./button-CWmUjKFj.js";import"./index-BAI3dK1t.js";import"./index-DjSeiq0_.js";import"./index-wkndwqac.js";import"./x-Ce74WkcZ.js";import"./createLucideIcon-DF5AlWng.js";import"./floating-ui.react-dom-Cbmwftv2.js";function J({lokasi:v,modelBarang:x,serialPerModel:y}){const{data:r,setData:d,post:N,processing:b,errors:o}=D({tanggal:"",lokasi_id:"",catatan:"",details:[]}),[t,g]=n.useState(""),[p,c]=n.useState(""),[s,m]=n.useState([]),[h,j]=n.useState([]),k=a=>(y[a]||[]).filter(i=>!s.includes(i));n.useEffect(()=>{t&&(j(k(t)),c(""))},[t,s]);const f=()=>{const a=p.trim();if(!a||s.includes(a))return;if(!h.includes(a)){alert("Serial number tidak valid untuk model ini.");return}m([...s,a]),c("")},S=a=>{m(s.filter(l=>l!==a))},w=()=>{!t||s.length===0||(d("details",[...r.details,{model_id:t,serial_numbers:s}]),g(""),m([]),j([]),c(""))},C=a=>{a.preventDefault(),N(route("stock-opname.store"))};return e.jsx(F,{children:e.jsx("div",{className:"p-6",children:e.jsxs("form",{onSubmit:C,className:"space-y-6 rounded-xl bg-white p-6 shadow-sm",children:[e.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Stock Opname"}),e.jsx("button",{type:"submit",disabled:b,className:"rounded-lg bg-blue-600 px-6 py-2 font-medium text-white transition-colors hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-50",children:b?"Menyimpan...":"Simpan Stock Opname"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Tanggal"}),e.jsx("input",{type:"date",value:r.tanggal,onChange:a=>d("tanggal",a.target.value),className:"w-full rounded-lg border-gray-300 p-2.5 text-sm focus:border-blue-500 focus:ring-blue-500"}),o.tanggal&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.tanggal})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Lokasi"}),e.jsxs("select",{value:r.lokasi_id,onChange:a=>d("lokasi_id",a.target.value),className:"w-full rounded-lg border-gray-300 p-2.5 text-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Pilih Lokasi"}),v.map(a=>e.jsx("option",{value:a.id,children:a.nama},a.id))]}),o.lokasi_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.lokasi_id})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h2",{className:"mb-4 text-lg font-semibold text-gray-800",children:"Input Serial Fisik per Model"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Model Barang"}),e.jsxs("select",{value:t,onChange:a=>g(a.target.value),className:"w-full rounded-lg border-gray-300 p-2.5 text-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Pilih Model Barang"}),x.map(a=>e.jsxs("option",{value:a.id,children:["[",a.kategori?.nama,"] ",a.merek?.nama," ",a.nama]},a.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Serial Number"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{list:"serial-suggestion",type:"text",value:p,onChange:a=>c(a.target.value),onKeyDown:a=>a.key==="Enter"&&(a.preventDefault(),f()),placeholder:"Scan / input serial number",className:"flex-1 rounded-lg border-gray-300 p-2.5 text-sm focus:border-blue-500 focus:ring-blue-500"}),e.jsx("datalist",{id:"serial-suggestion",children:h.map(a=>e.jsx("option",{value:a},a))}),e.jsx("button",{type:"button",onClick:f,className:"rounded-lg bg-blue-600 px-4 text-white transition-colors hover:bg-blue-700",children:"Tambah"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Serial Fisik"}),e.jsx("div",{className:"flex min-h-10 flex-wrap gap-2 rounded-lg bg-gray-50 p-2",children:s.length>0?s.map((a,l)=>e.jsxs("span",{className:"inline-flex items-center rounded-full bg-blue-100 px-3 py-1 text-sm text-blue-800",children:[a,e.jsx("button",{type:"button",className:"ml-1.5 text-blue-600 hover:text-blue-800",onClick:()=>S(a),children:"Ã—"})]},l)):e.jsx("span",{className:"text-sm text-gray-500",children:"Belum ada serial"})})]}),e.jsx("button",{type:"button",onClick:w,disabled:!t||s.length===0,className:"w-full rounded-lg bg-green-600 px-4 py-2 font-medium text-white transition-colors hover:bg-green-700 disabled:cursor-not-allowed disabled:opacity-50",children:"Tambah ke List"})]})]}),r.details.length>0&&e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h2",{className:"mb-4 text-lg font-semibold text-gray-800",children:"Barang yang Diinput"}),e.jsx("div",{className:"space-y-3",children:r.details.map((a,l)=>{const i=x.find(u=>u.id.toString()===a.model_id);return e.jsxs("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-4",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-gray-900",children:["[",i?.kategori?.nama,"] ",i?.merek?.nama," ",i?.nama]}),e.jsxs("p",{className:"mt-1 text-sm text-gray-600",children:["Jumlah Fisik: ",e.jsx("span",{className:"font-medium",children:a.serial_numbers.length})]})]})}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:a.serial_numbers.map((u,_)=>e.jsx("span",{className:"rounded-full border border-gray-200 bg-white px-2.5 py-1 text-xs",children:u},_))})]},l)})})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("label",{className:"mb-1 block text-sm font-medium text-gray-700",children:"Catatan Umum"}),e.jsx("textarea",{value:r.catatan,onChange:a=>d("catatan",a.target.value),className:"w-full rounded-lg border-gray-300 p-2.5 text-sm focus:border-blue-500 focus:ring-blue-500",rows:3,placeholder:"Tambahkan catatan jika diperlukan..."})]})]})})})}export{J as default};

import{a as T,u as F,j as e,L as J,r as x}from"./app-CqDem4Iv.js";import{s as W,B as A}from"./TransactionPreview-HCgP8qzV.js";import{A as D}from"./app-layout-CO-j32QL.js";import{S as M}from"./sweetalert2.esm.all-BrPZ0DEU.js";/* empty css            */import"./button-D25-2m8W.js";import"./index-B3PMF5vv.js";import"./index-D3xMyuYw.js";import"./index-DQS2yhzL.js";import"./x-skuTRX_H.js";import"./createLucideIcon-nI3AvfOo.js";import"./floating-ui.react-dom-BcAq-xRk.js";const H=({item:a,index:n,onItemChange:o,onRemove:j,errors:g,lists:l,usedModels:m})=>{const[N,p]=x.useState([]),[b,f]=x.useState([]),[y,_]=x.useState([]),[z,v]=x.useState(!1),[i,d]=x.useState(!1);x.useEffect(()=>{if(!a.kategori){p([]);return}v(!0),fetch(`/ajax/jenis-barang?kategori=${encodeURIComponent(a.kategori)}`).then(r=>r.json()).then(r=>p(r)).finally(()=>v(!1))},[a.kategori]),x.useEffect(()=>{if(!a.jenis_barang){f([]);return}d(!0),fetch(`/ajax/model-barang?jenis_barang=${encodeURIComponent(a.jenis_barang)}`).then(r=>r.json()).then(r=>f(r)).finally(()=>d(!1))},[a.jenis_barang]);const c=r=>{const t=l.rakList.filter(s=>s.nama_rak===r).map(s=>s.baris);_(t),o(n,{...a,rak_nama:r,rak_baris:"",rak_id:null})},k=r=>{const t=l.rakList.find(s=>s.nama_rak===a.rak_nama&&s.baris===r);o(n,{...a,rak_baris:r,rak_id:t?t.id:null})},h=(r,t)=>{const s={...a,[r]:t};r==="kategori"?(s.jenis_barang="",s.model=""):r==="jenis_barang"&&(s.model=""),o(n,s)},E=(r,t)=>{const s=[...a.serial_numbers];s[r]=t,o(n,{...a,serial_numbers:s})},P=()=>{o(n,{...a,serial_numbers:[...a.serial_numbers,""]})},R=r=>{const t=a.serial_numbers.filter((s,$)=>$!==r);o(n,{...a,serial_numbers:t})},u=r=>g&&g[`items.${n}.${r}`],S=u("kategori"),C=u("merek"),B=u("jenis_barang"),L=u("model"),w=u("rak_id"),O=b.filter(r=>!m.includes(r));return e.jsxs("div",{className:"relative mb-6 rounded-xl border border-gray-200 bg-white p-5 shadow-sm dark:border-zinc-700 dark:bg-zinc-900",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between border-b border-gray-100 pb-3 dark:border-zinc-800",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white",children:["Barang #",n+1]}),j&&e.jsx("button",{type:"button",onClick:j,className:"rounded-md bg-red-50 px-3 py-1 text-sm font-medium text-red-600 hover:bg-red-100 dark:bg-red-900/20 dark:text-red-400 dark:hover:bg-red-900/30",children:"Ã— Hapus"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Kategori"}),e.jsx("input",{type:"text",list:"kategori-suggest",className:`w-full rounded-lg border px-3 py-2 shadow-sm transition focus:ring-2 focus:ring-blue-500 dark:bg-zinc-800 dark:text-white ${S?"border-red-500 bg-red-50 dark:bg-red-900/10":"border-gray-300 dark:border-zinc-600"}`,value:a.kategori,onChange:r=>h("kategori",r.target.value),placeholder:"Pilih atau ketik kategori..."}),e.jsx("datalist",{id:"kategori-suggest",children:l.kategoriList.map(r=>e.jsx("option",{value:r.nama},r.id))}),S&&e.jsx("p",{className:"text-xs text-red-500",children:S})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Merek"}),e.jsx("input",{type:"text",list:"merek-suggest",className:`w-full rounded-lg border px-3 py-2 shadow-sm transition focus:ring-2 focus:ring-blue-500 dark:bg-zinc-800 dark:text-white ${C?"border-red-500 bg-red-50 dark:bg-red-900/10":"border-gray-300 dark:border-zinc-600"}`,value:a.merek,onChange:r=>h("merek",r.target.value),placeholder:"Pilih atau ketik merek..."}),e.jsx("datalist",{id:"merek-suggest",children:l.merekList.map(r=>e.jsx("option",{value:r.nama},r.id))}),C&&e.jsx("p",{className:"text-xs text-red-500",children:C})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:["Jenis Barang",z&&e.jsx("span",{className:"ml-2 text-xs text-gray-400",children:"(memuat...)"})]}),e.jsx("input",{type:"text",list:`jenis-suggest-${n}`,className:`w-full rounded-lg border px-3 py-2 shadow-sm transition focus:ring-2 focus:ring-blue-500 dark:bg-zinc-800 dark:text-white ${B?"border-red-500 bg-red-50 dark:bg-red-900/10":"border-gray-300 dark:border-zinc-600"}`,value:a.jenis_barang,onChange:r=>h("jenis_barang",r.target.value),placeholder:"Pilih atau ketik jenis..."}),e.jsx("datalist",{id:`jenis-suggest-${n}`,children:N.map(r=>e.jsx("option",{value:r},r))}),B&&e.jsx("p",{className:"text-xs text-red-500",children:B})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:["Model",i&&e.jsx("span",{className:"ml-2 text-xs text-gray-400",children:"(memuat...)"})]}),e.jsx("input",{type:"text",list:`model-suggest-${n}`,className:`w-full rounded-lg border px-3 py-2 shadow-sm transition focus:ring-2 focus:ring-blue-500 dark:bg-zinc-800 dark:text-white ${L?"border-red-500 bg-red-50 dark:bg-red-900/10":"border-gray-300 dark:border-zinc-600"}`,value:a.model,onChange:r=>h("model",r.target.value),placeholder:"Pilih atau ketik model..."}),e.jsx("datalist",{id:`model-suggest-${n}`,children:O.map(r=>e.jsx("option",{value:r},r))}),L&&e.jsx("p",{className:"text-xs text-red-500",children:L})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Nama Rak"}),e.jsxs("select",{className:`w-full rounded-lg border px-3 py-2 shadow-sm transition focus:ring-2 focus:ring-blue-500 dark:bg-zinc-800 dark:text-white ${w?"border-red-500 bg-red-50 dark:bg-red-900/10":"border-gray-300 dark:border-zinc-600"}`,value:a.rak_nama,onChange:r=>c(r.target.value),children:[e.jsx("option",{value:"",children:"-- Pilih Rak --"}),[...new Set(l.rakList.map(r=>r.nama_rak))].map(r=>e.jsx("option",{value:r,children:r},r))]}),w&&e.jsx("p",{className:"text-xs text-red-500",children:w})]}),y.length>0&&e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Baris"}),e.jsxs("select",{className:`w-full rounded-lg border px-3 py-2 shadow-sm transition focus:ring-2 focus:ring-blue-500 dark:bg-zinc-800 dark:text-white ${w&&!a.rak_baris?"border-red-500 bg-red-50 dark:bg-red-900/10":"border-gray-300 dark:border-zinc-600"}`,value:a.rak_baris,onChange:r=>k(r.target.value),children:[e.jsx("option",{value:"",children:"-- Pilih Baris --"}),y.map(r=>e.jsx("option",{value:r,children:r},r))]})]})]}),e.jsxs("div",{className:"mt-5 rounded-lg border border-gray-200 bg-gray-50/50 p-4 dark:border-zinc-700 dark:bg-zinc-800/50",children:[e.jsxs("div",{className:"mb-3 flex items-center justify-between",children:[e.jsxs("label",{className:"text-sm font-semibold text-gray-800 dark:text-white",children:["Serial Number",e.jsxs("span",{className:"ml-2 rounded-full bg-blue-100 px-2 py-0.5 text-xs text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",children:[a.serial_numbers.filter(r=>r.trim()).length," unit"]})]}),e.jsx(A,{existingSerials:a.serial_numbers,onSerialsParsed:r=>{const t=[...a.serial_numbers.filter(s=>s.trim()),...r];o(n,{...a,serial_numbers:t.length>0?t:[""]})}})]}),a.serial_numbers.map((r,t)=>{const s=g&&g[`items.${n}.serial_numbers.${t}`];return e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",className:`flex-1 rounded-lg border px-3 py-2 shadow-sm transition focus:ring-2 focus:ring-blue-500 dark:bg-zinc-800 dark:text-white ${s?"border-red-500 bg-red-50 dark:bg-red-900/10":"border-gray-300 dark:border-zinc-600"}`,value:r,onChange:$=>E(t,$.target.value),placeholder:`Serial #${t+1}`}),a.serial_numbers.length>1&&e.jsx("button",{type:"button",className:"rounded-md bg-red-50 px-2 py-1 text-xs font-medium text-red-600 hover:bg-red-100 dark:bg-red-900/20 dark:text-red-400 dark:hover:bg-red-900/30",onClick:()=>R(t),children:"Hapus"})]}),s&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:s})]},t)}),e.jsxs("button",{type:"button",className:"mt-2 inline-flex items-center gap-1 rounded-md border border-gray-300 bg-white px-3 py-1.5 text-sm font-medium text-gray-700 hover:bg-gray-50 dark:border-zinc-600 dark:bg-zinc-800 dark:text-gray-300 dark:hover:bg-zinc-700",onClick:P,children:[e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Tambah Serial"]}),u("serial_numbers")&&e.jsx("p",{className:"mt-2 text-xs text-red-500",children:u("serial_numbers")})]})]})};function ae(){const{kategoriList:a,asalList:n,merekList:o,rakList:j}=T().props,g={kategori:"",merek:"",jenis_barang:"",model:"",rak_nama:"",rak_baris:"",rak_id:null,serial_numbers:[""]},{data:l,setData:m,post:N,processing:p,errors:b,reset:f}=F({tanggal:new Date().toISOString().slice(0,10),asal_barang:"",items:[g]}),y=(i,d)=>{const c=[...l.items];c[i]=d,m("items",c)},_=()=>{m("items",[...l.items,g])},z=i=>{const d=l.items.filter((c,k)=>k!==i);m("items",d)},v=async i=>{i.preventDefault(),await W(l,"masuk")&&N(route("barang-masuk.store"),{onSuccess:()=>{M.fire({icon:"success",title:"Berhasil",text:"Data barang masuk berhasil disimpan!",timer:2e3,showConfirmButton:!1}),f()},onError:c=>{M.fire({icon:"error",title:"Gagal",text:"Periksa kembali isian form Anda. Pastikan semua field wajib terisi dan serial number tidak duplikat."})}})};return e.jsx(D,{children:e.jsx("div",{className:"min-h-screen bg-gray-50 p-4 sm:p-6 dark:bg-zinc-950",children:e.jsxs("div",{className:"mx-auto max-w-5xl",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Buat Transaksi Barang Masuk"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"Tambahkan barang baru ke gudang"})]}),e.jsxs("form",{onSubmit:v,className:"rounded-xl border border-gray-200 bg-white p-6 shadow-sm dark:border-zinc-700 dark:bg-zinc-900",children:[e.jsxs("div",{className:"mb-6 grid grid-cols-1 gap-6 border-b border-gray-100 pb-6 md:grid-cols-2 dark:border-zinc-800",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Tanggal"}),e.jsx("input",{type:"date",className:"w-full rounded-lg border border-gray-300 px-3 py-2 shadow-sm transition focus:ring-2 focus:ring-blue-500 dark:border-zinc-600 dark:bg-zinc-800 dark:text-white",value:l.tanggal,onChange:i=>m("tanggal",i.target.value)}),b.tanggal&&e.jsx("p",{className:"text-xs text-red-500",children:b.tanggal})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Asal Barang"}),e.jsx("input",{type:"text",list:"asal-suggest",className:"w-full rounded-lg border border-gray-300 px-3 py-2 shadow-sm transition focus:ring-2 focus:ring-blue-500 dark:border-zinc-600 dark:bg-zinc-800 dark:text-white",value:l.asal_barang,onChange:i=>m("asal_barang",i.target.value),placeholder:"Pilih atau ketik asal barang..."}),e.jsx("datalist",{id:"asal-suggest",children:n.map(i=>e.jsx("option",{value:i.nama},i.id))}),b.asal_barang&&e.jsx("p",{className:"text-xs text-red-500",children:b.asal_barang})]})]}),l.items.map((i,d)=>{const c=l.items.filter((k,h)=>h!==d).map(k=>k.model).filter(Boolean);return e.jsx(H,{item:i,index:d,onItemChange:y,onRemove:l.items.length>1?()=>z(d):void 0,errors:b,lists:{kategoriList:a,merekList:o,rakList:j},usedModels:c},d)}),e.jsxs("div",{className:"mt-8 flex flex-col items-center justify-between gap-4 border-t border-gray-100 pt-6 sm:flex-row dark:border-zinc-800",children:[e.jsxs("button",{type:"button",onClick:_,className:"inline-flex items-center gap-2 rounded-lg bg-emerald-500 px-4 py-2.5 text-sm font-medium text-white shadow-sm transition hover:bg-emerald-600 dark:bg-emerald-600 dark:hover:bg-emerald-700",children:[e.jsx("svg",{className:"h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Tambah Jenis Barang"]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(J,{href:route("barang-masuk.index"),className:"inline-flex items-center gap-2 rounded-lg border border-gray-300 bg-white px-5 py-2.5 text-sm font-medium text-gray-700 shadow-sm transition hover:bg-gray-50 dark:border-zinc-600 dark:bg-zinc-800 dark:text-gray-300 dark:hover:bg-zinc-700",children:[e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Kembali"]}),e.jsx("button",{type:"submit",disabled:p,className:"inline-flex items-center gap-2 rounded-lg bg-blue-600 px-6 py-2.5 text-sm font-medium text-white shadow-sm transition hover:bg-blue-700 disabled:opacity-50 dark:bg-blue-500 dark:hover:bg-blue-600",children:p?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"h-4 w-4 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"Menyimpan..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Simpan Transaksi"]})})]})]})]})]})})})}export{ae as default};

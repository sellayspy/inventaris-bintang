import{r,j as e,b as n,f as S}from"./app-B0SzeqCG.js";import{a as I,A as v}from"./app-layout-BnD_lHqo.js";/* empty css            */import"./button-CWmUjKFj.js";import"./index-BAI3dK1t.js";import"./index-DjSeiq0_.js";import"./index-wkndwqac.js";import"./x-Ce74WkcZ.js";import"./createLucideIcon-DF5AlWng.js";import"./floating-ui.react-dom-Cbmwftv2.js";function B({auth:m,stokPerbaikan:p}){const[b,i]=r.useState(!1),[u,o]=r.useState(!1),g=m.permissions||[],[d,c]=r.useState(null),[j,x]=r.useState([]),[t,h]=r.useState([]),y=async s=>{c(s),o(!0),i(!0);try{const a=await S.get(route("stock.perbaikan.show",{model_id:s.model_id,lokasi_id:s.lokasi_id}));x(a.data)}catch(a){console.error("Gagal mengambil detail barang:",a),l()}finally{o(!1)}},l=()=>{i(!1),c(null),x([]),h([])},N=s=>{h(a=>a.includes(s)?a.filter(w=>w!==s):[...a,s])},f=s=>{if(s.preventDefault(),t.length===0){alert("Pilih setidaknya satu barang untuk diselesaikan.");return}n.post(route("stock.perbaikan.selesai"),{barang_ids:t},{onSuccess:()=>{l()},onError:a=>{console.error(a),alert("Terjadi kesalahan. Silakan coba lagi.")}})},k=g.includes(I.EDIT_STOK_DIPERBAIKI);return e.jsxs(v,{children:[e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"mb-4 text-2xl font-bold",children:"Stok Sedang Diperbaiki (Gudang)"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full border border-gray-300",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border px-4 py-2 text-left",children:"Lokasi"}),e.jsx("th",{className:"border px-4 py-2 text-left",children:"Kategori"}),e.jsx("th",{className:"border px-4 py-2 text-left",children:"Nama Barang"}),e.jsx("th",{className:"border px-4 py-2 text-right",children:"Jumlah"}),e.jsx("th",{className:"border px-4 py-2 text-center",children:"Aksi"})]})}),e.jsx("tbody",{children:p.map((s,a)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"border px-4 py-2",children:s.lokasi}),e.jsx("td",{className:"border px-4 py-2",children:s.kategori}),e.jsx("td",{className:"border px-4 py-2",children:s.nama_barang}),e.jsx("td",{className:"border px-4 py-2 text-right",children:s.jumlah_perbaikan}),e.jsx("td",{className:"border px-4 py-2 text-center",children:e.jsx("button",{onClick:()=>y(s),className:"rounded bg-blue-500 px-3 py-1 text-sm font-semibold text-white shadow-sm hover:bg-blue-600",children:"Detail"})})]},a))})]})})]}),b&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-transparent",children:e.jsxs("div",{className:"w-full max-w-2xl rounded-lg bg-white p-6 shadow-xl",children:[e.jsxs("h2",{className:"mb-2 text-xl font-bold",children:["Detail Perbaikan: ",d?.nama_barang]}),e.jsxs("p",{className:"mb-4 text-sm text-gray-600",children:["Lokasi: ",d?.lokasi]}),u?e.jsx("p",{children:"Memuat data..."}):e.jsxs("form",{onSubmit:f,children:[e.jsx("div",{className:"h-64 overflow-y-auto border",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"sticky top-0 bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2",children:e.jsx("input",{type:"checkbox",disabled:!0})}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Serial Number"}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Kondisi Awal"})]})}),e.jsx("tbody",{children:j.map(s=>e.jsxs("tr",{className:"hover:bg-gray-100",children:[e.jsx("td",{className:"px-4 py-2 text-center",children:e.jsx("input",{type:"checkbox",checked:t.includes(s.id),onChange:()=>N(s.id)})}),e.jsx("td",{className:"px-4 py-2",children:s.serial_number}),e.jsx("td",{className:"px-4 py-2",children:s.kondisi_awal})]},s.id))})]})}),e.jsxs("div",{className:"mt-6 flex justify-end gap-4",children:[e.jsx("button",{type:"button",onClick:l,className:"rounded bg-gray-200 px-4 py-2 text-sm font-semibold text-gray-800 hover:bg-gray-300",children:"Batal"}),k&&e.jsx("button",{type:"submit",disabled:t.length===0||n.processing,className:"rounded bg-green-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-green-700 disabled:cursor-not-allowed disabled:opacity-50",children:n.processing?"Memproses...":`Selesaikan Perbaikan (${t.length})`})]})]})]})})]})}export{B as default};

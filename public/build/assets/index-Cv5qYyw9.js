import{r,j as e,L as v,b as l,f as S}from"./app-B0SzeqCG.js";import{A as C}from"./app-layout-BnD_lHqo.js";/* empty css            */import"./button-CWmUjKFj.js";import"./index-BAI3dK1t.js";import"./index-DjSeiq0_.js";import"./index-wkndwqac.js";import"./x-Ce74WkcZ.js";import"./createLucideIcon-DF5AlWng.js";import"./floating-ui.react-dom-Cbmwftv2.js";function E({stokRusak:u}){const[p,d]=r.useState(!1),[b,o]=r.useState(!1),[g,c]=r.useState(null),[j,h]=r.useState([]),[a,x]=r.useState([]),[n,m]=r.useState(""),y=async s=>{c(s),o(!0),d(!0);try{const t=await S.get(route("stock.rusak.show"),{params:{model_id:s.model_id,lokasi_id:s.lokasi_id}});h(t.data)}catch(t){console.error("Gagal mengambil detail barang:",t),i()}finally{o(!1)}},i=()=>{d(!1),c(null),h([]),x([]),m("")},k=s=>{x(t=>t.includes(s)?t.filter(w=>w!==s):[...t,s])},f=()=>{a.length!==0&&l.post(route("stock.rusak.perbaiki"),{barang_ids:a},{onSuccess:()=>i(),preserveScroll:!0})},N=()=>{if(a.length===0){alert("Pilih setidaknya satu barang.");return}if(!n.trim()){alert("Alasan pemusnahan wajib diisi.");return}l.post(route("stock.rusak.pemusnahan.ajukan"),{barang_ids:a,alasan:n},{onSuccess:()=>i(),preserveScroll:!0})};return e.jsxs(C,{children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Stok Rusak (Gudang)"}),e.jsx(v,{href:route("stock.rusak.pemusnahan.index"),className:"rounded bg-blue-600 px-4 py-2 text-white hover:bg-blue-700",children:"Lihat Daftar Pemusnahan"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full border border-gray-300",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border px-4 py-2 text-left",children:"Lokasi"}),e.jsx("th",{className:"border px-4 py-2 text-left",children:"Kategori"}),e.jsx("th",{className:"border px-4 py-2 text-left",children:"Nama Barang"}),e.jsx("th",{className:"border px-4 py-2 text-right",children:"Jumlah"}),e.jsx("th",{className:"border px-4 py-2 text-center",children:"Aksi"})]})}),e.jsx("tbody",{children:u.map((s,t)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"border px-4 py-2",children:s.lokasi}),e.jsx("td",{className:"border px-4 py-2",children:s.kategori}),e.jsx("td",{className:"border px-4 py-2",children:s.nama_barang}),e.jsx("td",{className:"border px-4 py-2 text-right",children:s.jumlah_rusak}),e.jsx("td",{className:"border px-4 py-2 text-center",children:e.jsx("button",{onClick:()=>y(s),className:"rounded bg-blue-500 px-3 py-1 text-sm font-semibold text-white shadow-sm hover:bg-blue-600",children:"Detail"})})]},t))})]})})]}),p&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-transparent",children:e.jsxs("div",{className:"w-full max-w-2xl rounded-lg bg-white p-6 shadow-xl",children:[e.jsxs("h2",{className:"mb-2 text-xl font-bold",children:["Detail Barang Rusak: ",g?.nama_barang]}),e.jsx("p",{className:"mb-4 text-sm text-gray-600",children:"Pilih barang yang akan diproses."}),b?e.jsx("p",{children:"Memuat data..."}):e.jsxs("div",{children:[e.jsx("div",{className:"h-64 overflow-y-auto border",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{className:"sticky top-0 bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-16 px-4 py-2",children:e.jsx("input",{type:"checkbox",disabled:!0})}),e.jsx("th",{className:"px-4 py-2 text-left",children:"Serial Number"})]})}),e.jsx("tbody",{children:j.map(s=>e.jsxs("tr",{className:"hover:bg-gray-100",children:[e.jsx("td",{className:"px-4 py-2 text-center",children:e.jsx("input",{type:"checkbox",checked:a.includes(s.id),onChange:()=>k(s.id)})}),e.jsx("td",{className:"px-4 py-2",children:s.serial_number})]},s.id))})]})}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{htmlFor:"alasan",className:"block text-sm font-medium text-gray-700",children:"Alasan Pemusnahan (Wajib diisi jika ingin memusnahkan)"}),e.jsx("textarea",{id:"alasan",value:n,onChange:s=>m(s.target.value),rows:3,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm",placeholder:"Contoh: Barang rusak parah akibat terjatuh, tidak bisa diperbaiki."})]}),e.jsxs("div",{className:"mt-6 flex justify-between",children:[e.jsx("button",{onClick:N,disabled:a.length===0||!n.trim()||l.processing,className:"rounded bg-red-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-red-700 disabled:cursor-not-allowed disabled:opacity-50",children:l.processing?"Memproses...":`Ajukan Pemusnahan (${a.length})`}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:i,type:"button",className:"rounded bg-gray-200 px-4 py-2 text-sm font-semibold text-gray-800 hover:bg-gray-300",children:"Batal"}),e.jsx("button",{onClick:f,disabled:a.length===0||l.processing,className:"rounded bg-blue-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-50",children:l.processing?"Memproses...":`Pindah ke Perbaikan (${a.length})`})]})]})]})]})})]})}export{E as default};
